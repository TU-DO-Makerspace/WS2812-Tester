<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WS2812 Tester: SizeEncoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WS2812 Tester
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSizeEncoder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SizeEncoder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The size encoder class.  
 <a href="classSizeEncoder.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SizeEncoder_8h_source.html">SizeEncoder.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a57e9107b1b4235688463e60d954ef87e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a57e9107b1b4235688463e60d954ef87e">SizeEncoder</a> (uint8_t pin_a, uint8_t pin_b, unsigned long ready_time_ms)</td></tr>
<tr class="memdesc:a57e9107b1b4235688463e60d954ef87e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSizeEncoder.html#a57e9107b1b4235688463e60d954ef87e">More...</a><br /></td></tr>
<tr class="separator:a57e9107b1b4235688463e60d954ef87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a02e76999bb9c5705cfafa1d7c8940"><td class="memItemLeft" align="right" valign="top"><a id="a03a02e76999bb9c5705cfafa1d7c8940"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a03a02e76999bb9c5705cfafa1d7c8940">~SizeEncoder</a> ()</td></tr>
<tr class="memdesc:a03a02e76999bb9c5705cfafa1d7c8940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a03a02e76999bb9c5705cfafa1d7c8940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51be5eb84b824327af1a69fe463f47ca"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a51be5eb84b824327af1a69fe463f47ca">ready_pos</a> ()</td></tr>
<tr class="memdesc:a51be5eb84b824327af1a69fe463f47ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Position of the encoder after it is "ready".  <a href="classSizeEncoder.html#a51be5eb84b824327af1a69fe463f47ca">More...</a><br /></td></tr>
<tr class="separator:a51be5eb84b824327af1a69fe463f47ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b7e011607d34ab11168299030d7744e"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a8b7e011607d34ab11168299030d7744e">t_since_last_change</a> ()</td></tr>
<tr class="memdesc:a8b7e011607d34ab11168299030d7744e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time (ms) since the last encoder change.  <a href="classSizeEncoder.html#a8b7e011607d34ab11168299030d7744e">More...</a><br /></td></tr>
<tr class="separator:a8b7e011607d34ab11168299030d7744e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105e6920bbd549c0f4751e26c4d6a564"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a105e6920bbd549c0f4751e26c4d6a564">ready</a> ()</td></tr>
<tr class="memdesc:a105e6920bbd549c0f4751e26c4d6a564"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if the encoder is considered "ready" to be read.  <a href="classSizeEncoder.html#a105e6920bbd549c0f4751e26c4d6a564">More...</a><br /></td></tr>
<tr class="separator:a105e6920bbd549c0f4751e26c4d6a564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16b39cc95f837b3b88c092416de4e20"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#ab16b39cc95f837b3b88c092416de4e20">update</a> ()</td></tr>
<tr class="memdesc:ab16b39cc95f837b3b88c092416de4e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the <a class="el" href="classSizeEncoder.html" title="The size encoder class.">SizeEncoder</a> class. Call this function periodically with high priority!  <a href="classSizeEncoder.html#ab16b39cc95f837b3b88c092416de4e20">More...</a><br /></td></tr>
<tr class="separator:ab16b39cc95f837b3b88c092416de4e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7cfadc28a4c9a679a874577c858518be"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a7cfadc28a4c9a679a874577c858518be">read_enc</a> ()</td></tr>
<tr class="memdesc:a7cfadc28a4c9a679a874577c858518be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current position of the encoder.  <a href="classSizeEncoder.html#a7cfadc28a4c9a679a874577c858518be">More...</a><br /></td></tr>
<tr class="separator:a7cfadc28a4c9a679a874577c858518be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c34473764fd28aff5b24f48f3d7fb2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSizeEncoder.html#a4c34473764fd28aff5b24f48f3d7fb2d">prep_rdy</a> ()</td></tr>
<tr class="memdesc:a4c34473764fd28aff5b24f48f3d7fb2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares rdy and rdy_tstamp.  <a href="classSizeEncoder.html#a4c34473764fd28aff5b24f48f3d7fb2d">More...</a><br /></td></tr>
<tr class="separator:a4c34473764fd28aff5b24f48f3d7fb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa2fafba2e1239bf86c5a6d7b5ada8df5"><td class="memItemLeft" align="right" valign="top"><a id="aa2fafba2e1239bf86c5a6d7b5ada8df5"></a>
Encoder *&#160;</td><td class="memItemRight" valign="bottom"><b>enc</b></td></tr>
<tr class="separator:aa2fafba2e1239bf86c5a6d7b5ada8df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45df80b5df258daaeab80840b03aa09b"><td class="memItemLeft" align="right" valign="top"><a id="a45df80b5df258daaeab80840b03aa09b"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>ready_time</b></td></tr>
<tr class="separator:a45df80b5df258daaeab80840b03aa09b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374aa4330cd0a46d8e38446e1e4ab5fd"><td class="memItemLeft" align="right" valign="top"><a id="a374aa4330cd0a46d8e38446e1e4ab5fd"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>saved_pos</b></td></tr>
<tr class="separator:a374aa4330cd0a46d8e38446e1e4ab5fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a564078d53e2be08fd356aad34ff532d5"><td class="memItemLeft" align="right" valign="top"><a id="a564078d53e2be08fd356aad34ff532d5"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>rdy_pos</b></td></tr>
<tr class="separator:a564078d53e2be08fd356aad34ff532d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f87652ef6d63c473db0b67a2e096809"><td class="memItemLeft" align="right" valign="top"><a id="a1f87652ef6d63c473db0b67a2e096809"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>rdy</b></td></tr>
<tr class="separator:a1f87652ef6d63c473db0b67a2e096809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc4eda472d736e61a62d471514c15ca"><td class="memItemLeft" align="right" valign="top"><a id="a2dc4eda472d736e61a62d471514c15ca"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>rdy_tstamp</b></td></tr>
<tr class="separator:a2dc4eda472d736e61a62d471514c15ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19bdedd4ae2f6b2b81f0c9541d1d40c0"><td class="memItemLeft" align="right" valign="top"><a id="a19bdedd4ae2f6b2b81f0c9541d1d40c0"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>last_change_tstamp</b></td></tr>
<tr class="separator:a19bdedd4ae2f6b2b81f0c9541d1d40c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The size encoder class. </p>
<p>The following class is used to handle the rotary encoder which sets the strip size. </p>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8h_source.html#l00041">41</a> of file <a class="el" href="SizeEncoder_8h_source.html">SizeEncoder.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a57e9107b1b4235688463e60d954ef87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57e9107b1b4235688463e60d954ef87e">&#9670;&nbsp;</a></span>SizeEncoder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SizeEncoder::SizeEncoder </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>ready_time_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>The following constructor receives the A and B pins of the encoder, as well as the time after which the encoder value is considered to be ready to be read (see <a class="el" href="classSizeEncoder.html#a105e6920bbd549c0f4751e26c4d6a564" title="Returns if the encoder is considered &quot;ready&quot; to be read.">ready()</a> for more info).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uint8_t</td><td>a_pin The Arduino pin connected to the encoders A pin. </td></tr>
    <tr><td class="paramname">uint8_t</td><td>b_pin The Arduino number of the B pin. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00046">46</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;: enc(<span class="keyword">new</span> Encoder(pin_a, pin_b)), ready_time(ready_time_ms)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    saved_pos = <a class="code" href="classSizeEncoder.html#a7cfadc28a4c9a679a874577c858518be">read_enc</a>();</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    rdy_pos = saved_pos;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classSizeEncoder.html#a4c34473764fd28aff5b24f48f3d7fb2d">prep_rdy</a>();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;};</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="SizeEncoder_8cpp_source.html#l00039">prep_rdy()</a>, and <a class="el" href="SizeEncoder_8cpp_source.html#l00033">read_enc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4c34473764fd28aff5b24f48f3d7fb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c34473764fd28aff5b24f48f3d7fb2d">&#9670;&nbsp;</a></span>prep_rdy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SizeEncoder::prep_rdy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepares rdy and rdy_tstamp. </p>
<p>The following function sets the rdy flag and sets the rdy_tstamp. See the <a class="el" href="classSizeEncoder.html#a105e6920bbd549c0f4751e26c4d6a564" title="Returns if the encoder is considered &quot;ready&quot; to be read.">ready()</a> method for more info. </p>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00039">39</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    rdy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    rdy_tstamp = millis() + ready_time;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="SizeEncoder_8cpp_source.html#l00046">SizeEncoder()</a>, and <a class="el" href="SizeEncoder_8cpp_source.html#l00061">update()</a>.</p>

</div>
</div>
<a id="a7cfadc28a4c9a679a874577c858518be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cfadc28a4c9a679a874577c858518be">&#9670;&nbsp;</a></span>read_enc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long SizeEncoder::read_enc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the current position of the encoder. </p>
<p>The following function returns the current position of the rotary encoder. Before returning the position, the read value is shifted by SHFT_CORRECT_ENCODER_STEP_SIZE (see <a class="el" href="config_8h.html" title="Configuration file for the firmware.">config.h</a>) to ensure the value is returned in steps of 1.</p>
<dl class="section return"><dt>Returns</dt><dd>The current position of the encoder. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00033">33</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">return</span> enc-&gt;read() &gt;&gt; SHFT_CORRECT_ENCODER_STEP_SIZE;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="SizeEncoder_8cpp_source.html#l00046">SizeEncoder()</a>, and <a class="el" href="SizeEncoder_8cpp_source.html#l00061">update()</a>.</p>

</div>
</div>
<a id="a105e6920bbd549c0f4751e26c4d6a564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a105e6920bbd549c0f4751e26c4d6a564">&#9670;&nbsp;</a></span>ready()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SizeEncoder::ready </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns if the encoder is considered "ready" to be read. </p>
<p>The following function returns if the rotary encoder is considered "ready". To ensure the firmware can keep up with changes in the rotary encoder, we must ensure that the task of reading the rotary encoder is provided a high priority where no other tasks can interrupt the firmware from registering changes. Typically hardware interrupts can solve this issue, however, since writing to the LED strip requires hardware interrupts to be disabled, just relying in interrupts in itself will still result in rotary encoder changes getting "skipped" (especially as the LED strip size increases as transmissions take longer to reach the end of the strip). Thus, the solution to fix this issue is to halt the firmware from doing anything else than listening for rotary encoder change until the rotary encoder has remained unchaged for a specific ammount of time (See ready_time_ms), after which it is considered "ready" to be read. The drawback of this is that the firmware cannot do anything else in the meantime, which for our application however, is perfectly acceptable.</p>
<dl class="section return"><dt>Returns</dt><dd>If the encoder is considered "ready" to be read </dd></dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00088">88</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> rdy;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51be5eb84b824327af1a69fe463f47ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51be5eb84b824327af1a69fe463f47ca">&#9670;&nbsp;</a></span>ready_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long SizeEncoder::ready_pos </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Position of the encoder after it is "ready". </p>
<p>The following function returns the position of the rotary encoder after it is considered as "ready" (see <a class="el" href="classSizeEncoder.html#a105e6920bbd549c0f4751e26c4d6a564" title="Returns if the encoder is considered &quot;ready&quot; to be read.">ready()</a> for more info)</p>
<dl class="section return"><dt>Returns</dt><dd>Position of the encoder after it is considered ready </dd></dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00094">94</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> rdy_pos;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b7e011607d34ab11168299030d7744e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b7e011607d34ab11168299030d7744e">&#9670;&nbsp;</a></span>t_since_last_change()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long SizeEncoder::t_since_last_change </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Time (ms) since the last encoder change. </p>
<p>The following function returns the time (in ms) that has passed since the last change of the rotary encoder.</p>
<dl class="section return"><dt>Returns</dt><dd>Time (ms) since last encoder change </dd></dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00100">100</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> millis() - last_change_tstamp;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab16b39cc95f837b3b88c092416de4e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16b39cc95f837b3b88c092416de4e20">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SizeEncoder::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the <a class="el" href="classSizeEncoder.html" title="The size encoder class.">SizeEncoder</a> class. Call this function periodically with high priority! </p>
<p>The following function updates the <a class="el" href="classSizeEncoder.html" title="The size encoder class.">SizeEncoder</a> class. It must be called periodically with high priority, meaning running time consuming tasks should be avoided when calling this function periodically. Violating the priorty requirements of this function will result in sluggish/laggy reading of the encoder.</p>
<dl class="section return"><dt>Returns</dt><dd>If rotary encoder position has changed </dd></dl>

<p class="definition">Definition at line <a class="el" href="SizeEncoder_8cpp_source.html#l00061">61</a> of file <a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">long</span> pos = <a class="code" href="classSizeEncoder.html#a7cfadc28a4c9a679a874577c858518be">read_enc</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (pos &lt; 0) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        pos = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        enc-&gt;write(0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">bool</span> changed = ((<span class="keywordtype">unsigned</span> long) pos != saved_pos);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (changed) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        saved_pos = pos;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        last_change_tstamp = millis();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="classSizeEncoder.html#a4c34473764fd28aff5b24f48f3d7fb2d">prep_rdy</a>();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!rdy) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (millis() &gt;= rdy_tstamp) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            rdy_pos = pos;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            rdy = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="SizeEncoder_8cpp_source.html#l00039">prep_rdy()</a>, and <a class="el" href="SizeEncoder_8cpp_source.html#l00033">read_enc()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="SizeEncoder_8h_source.html">SizeEncoder.h</a></li>
<li>src/<a class="el" href="SizeEncoder_8cpp_source.html">SizeEncoder.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassSizeEncoder_html_a7cfadc28a4c9a679a874577c858518be"><div class="ttname"><a href="classSizeEncoder.html#a7cfadc28a4c9a679a874577c858518be">SizeEncoder::read_enc</a></div><div class="ttdeci">long read_enc()</div><div class="ttdoc">Returns the current position of the encoder.</div><div class="ttdef"><b>Definition:</b> <a href="SizeEncoder_8cpp_source.html#l00033">SizeEncoder.cpp:33</a></div></div>
<div class="ttc" id="aclassSizeEncoder_html_a4c34473764fd28aff5b24f48f3d7fb2d"><div class="ttname"><a href="classSizeEncoder.html#a4c34473764fd28aff5b24f48f3d7fb2d">SizeEncoder::prep_rdy</a></div><div class="ttdeci">void prep_rdy()</div><div class="ttdoc">Prepares rdy and rdy_tstamp.</div><div class="ttdef"><b>Definition:</b> <a href="SizeEncoder_8cpp_source.html#l00039">SizeEncoder.cpp:39</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
